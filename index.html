<html lang="en">
    <head>
        <title>Antena3 resource index</title>
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="css/styleguide.min.css"/>
    </head>
    <body>
        <div class="Grid">
            <div class="Grid-inner">
                <div class="Grid-cell Grid-cell--col3">
                    <ul class="FloatingBox FloatingBox--left u-padding-xl">
                        <li class="button button--outline"><a href="global_animation.html" target="maps">Global animation</a></li>
                        <li class="button button--outline"><a href="spain_animation.html" target="maps">Spain animation</a></li>
                        <li class="button button--outline"><a href="catalonia_total_tweets_by_district.html" target="maps">Catalonia total tweets by district</a></li>
                        <li class="button button--outline"><a href="catalonia_winning_category_by_district.html" target="maps">Catalonia winning category by district</a></li>
                        <li class="button button--outline"><a href="single_tweet.html" target="maps">Single tweet</a></li>
                    </ul>
                    <ul class="FloatingBox FloatingBox--left u-padding-xl">
                        <li><p>Num tweets: <span id="num_tweets"></span></p></li>
                    </ul>
                </div>
                <div class="Grid-cell Grid-cell--col9">
                    <iframe style="width: 100%; height: 100%" name="maps"></iframe>
                </div>
            </div>
        </div>
        <script src="http://libs.cartocdn.com/cartodb.js/v3/3.15/cartodb.js"></script>
        <script>
            var sql = new cartodb.SQL({user: 'solutions'});
            sql.execute("" +
                        "SELECT count(catalonia_elections_twitter_test.the_geom) as num_tweets, gn_a1_code from catalonia_elections_twitter_test " +
                        "JOIN spain_provinces " +
                        "ON st_contains(spain_provinces.the_geom, catalonia_elections_twitter_test.the_geom) " +
                        "WHERE gn_a1_code = 'ES.B' OR gn_a1_code = 'ES.GI' OR gn_a1_code = 'ES.L' OR gn_a1_code = 'ES.T' GROUP BY gn_a1_code")
            .done(function (data) {
                sql.execute("SELECT count(*) as num_tweets FROM catalonia_elections_twitter_test")
                .done(function (data2) {
                            $("#num_tweets").text("" + data2.rows[0].num_tweets + " total (" +
                                    data.rows[0].num_tweets + " en " + data.rows[0].gn_a1_code + ", " +
                                    data.rows[1].num_tweets + " en " + data.rows[1].gn_a1_code + ", " +
                                    data.rows[2].num_tweets + " en " + data.rows[2].gn_a1_code + " y " +
                                    data.rows[3].num_tweets + " en " + data.rows[3].gn_a1_code + ")");
                        });
            })
        </script>
    </body>
</html>
